(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[851],{1105:function(e,t,a){Promise.resolve().then(a.bind(a,1350))},6491:function(e,t,a){"use strict";var n=a(1258),l=a(357);let i=new n.InstancesMannager(l.env.REACT_APP_API_URL||"https://contec.inf.br");t.Z=i},9582:function(e,t){"use strict";t.Z=function(e){return 13===e.length?"+".concat(e.slice(0,2)," (").concat(e.slice(2,4),") ").concat(e.slice(4,5)," ").concat(e.slice(5,9),"-").concat(e.slice(9,13)):12===e.length?"+".concat(e.slice(0,2)," (").concat(e.slice(2,4),") ").concat(e.slice(4,8),"-").concat(e.slice(8,12)):11===e.length?"(".concat(e.slice(0,2),") ").concat(e.slice(2,5),"-").concat(e.slice(5,8),"-").concat(e.slice(8,11)):10===e.length?"(".concat(e.slice(0,2),") ").concat(e.slice(2,6),"-").concat(e.slice(6,10)):e}},1350:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var n=a(7437),l=a(2265),i=a(3019),o=a.n(i),c=a(8520),d=a(5002),s=a(6286),r=a(2100),u=a(8924),_=a(5622),h=a(9582),m=a(7346),p=a(5211),O=a(4649),D=a(6491);let A=["ask_date","answer_date"],C=[],w=["attendance_id","customer_id","id"];async function f(e){let[t,a]=(0,O.createWhereString)({parameters:e,dateColumns:A,likeColumns:C,numberColumns:w}),n=await D.Z.executeQuery("natrielli","".concat("SELECT\n   wp.*,\n   cli.RAZAO,\n   cli.ATIVO,\n   cli.CPF_CNPJ,\n   cli.ESTADO,\n   cli.CIDADE\nFROM w_pesquisa_contato wp\nLEFT JOIN w_atendimentos wa ON wa.CODIGO = wp.attendance_id\nLEFT JOIN clientes cli ON cli.CODIGO = wp.customer_id\n","\n").concat(t),a).then(e=>e.result);return(0,O.toPaginated)(n,+e.page,+e.perPage)}p.kL.register(p.uw,p.f$,p.ZL,p.Dx,p.u,p.De);let g={"already-a-customer":"J\xe1 sou cliente ativo",recommendation:"Recomenda\xe7\xe3o",email:"E-mail",website:"Site da empresa",facebook:"Facebook",instagram:"Instagram",linkedin:"LinkedIn",other:"Outro"},x=[{title:"Cliente",dataIndex:"RAZAO",key:"RAZAO"},{title:"Ativo",dataIndex:"ATIVO",key:"ATIVO",render:(e,t)=>{let{ATIVO:a}=t;return(0,n.jsx)("span",{className:"".concat(o().tag," + ").concat(o()[a]),children:"SIM"===a?"Sim":"N\xe3o"})}},{title:"CPF/CNPJ",dataIndex:"CPF_CNPJ",key:"CPF_CNPJ"},{title:"M\xe9todo de contato",dataIndex:"contact_method",key:"contact_method",render:(e,t)=>{let{contact_method:a}=t;return(0,n.jsx)(n.Fragment,{children:a?g[a]:"N\xe3o respondeu"})}},{title:"Estado",dataIndex:"ESTADO",key:"ESTADO",render:e=>(0,n.jsx)(n.Fragment,{children:(0,h.Z)(e)})},{title:"Cidade",dataIndex:"CIDADE",key:"CIDADE"},{title:"In\xedcio avalia\xe7\xe3o",dataIndex:"ask_date",key:"ask_date",render:e=>(0,n.jsx)(n.Fragment,{children:new Date(e).toLocaleString()})},{title:"Fim avalia\xe7\xe3o",dataIndex:"answer_date",key:"answer_date",render:e=>(0,n.jsx)(n.Fragment,{children:new Date(e).toLocaleString()})}],{RangePicker:I}=c.default;function v(){let[e,t]=(0,l.useState)([]),[a,i]=(0,l.useState)([]),[c,h]=(0,l.useState)(!0),[p,O]=(0,l.useState)(1),[D,A]=(0,l.useState)(0),[C,w]=(0,l.useState)([]),[v,k]=(0,l.useState)([]),[S,E]=(0,l.useState)([]),[j,N]=(0,l.useState)({RAZAO:"",CPF_CNPJ:"",ATIVO:"",ESTADO:[],CIDADE:[],contact_method:[],ask_date_start:"",ask_date_end:"",answer_date_start:"",answer_date_end:""});(0,l.useEffect)(()=>{f({ORDENAR_POR:"ask_date",page:"1",perPage:"9999999"}).then(e=>{let{data:a}=e;t(a),i(a),A(a.length),h(!1);let n=Array.from(new Set(a.map(e=>e.ESTADO))),l=Array.from(new Set(a.map(e=>e.CIDADE))),o=Array.from(new Set(a.map(e=>e.RAZAO)));k(n),E(l),w(o)})},[]);let P=e=>t=>{N({...j,[e]:t})},{labels:y,counts:T}=(e=>{let t={};e.forEach(e=>{let a=e.contact_method?g[e.contact_method]:"N\xe3o respondeu";t[a]||(t[a]=0),t[a]++});let a=Object.keys(t),n=a.map(e=>t[e]);return{labels:a,counts:n}})(a);return(0,n.jsxs)("main",{className:o().main,children:[(0,n.jsxs)("div",{className:o()["filters-container"],children:[(0,n.jsx)(d.Z,{options:C.map(e=>({value:e})),style:{width:400},onChange:P("RAZAO"),placeholder:"Cliente",value:j.RAZAO}),(0,n.jsx)(s.Z,{placeholder:"CPF/CNPJ",style:{width:400},value:j.CPF_CNPJ,onChange:e=>P("CPF_CNPJ")(e.target.value)}),(0,n.jsxs)(r.default,{placeholder:"Ativo",style:{width:400},value:j.ATIVO,onChange:e=>P("ATIVO")(e),children:[(0,n.jsx)(r.default.Option,{value:"SIM",children:"Sim"}),(0,n.jsx)(r.default.Option,{value:"N\xc3O",children:"N\xe3o"}),(0,n.jsx)(r.default.Option,{value:"TODOS",children:"Todos"})]}),(0,n.jsx)(r.default,{mode:"multiple",placeholder:"Estado",style:{width:400},value:j.ESTADO,onChange:e=>P("ESTADO")(e),children:v.map(e=>(0,n.jsx)(r.default.Option,{value:e,children:e},e))}),(0,n.jsx)(r.default,{mode:"multiple",placeholder:"Cidade",style:{width:400},value:j.CIDADE,onChange:e=>P("CIDADE")(e),children:S.map(e=>(0,n.jsx)(r.default.Option,{value:e,children:e},e))}),(0,n.jsxs)(r.default,{mode:"multiple",placeholder:"M\xe9todo de contato",style:{width:400},value:j.contact_method,onChange:e=>P("contact_method")(e),children:[(0,n.jsx)(r.default.Option,{value:"email",children:"Email"}),(0,n.jsx)(r.default.Option,{value:"already-a-customer",children:"J\xe1 sou cliente ativo"}),(0,n.jsx)(r.default.Option,{value:"recommendation",children:"Recomenda\xe7\xe3o"}),(0,n.jsx)(r.default.Option,{value:"website",children:"Site da empresa"}),(0,n.jsx)(r.default.Option,{value:"facebook",children:"Facebook"}),(0,n.jsx)(r.default.Option,{value:"instagram",children:"Instagram"}),(0,n.jsx)(r.default.Option,{value:"linkedin",children:"LinkedIn"}),(0,n.jsx)(r.default.Option,{value:"other",children:"Outro"})]}),(0,n.jsx)(I,{format:"YYYY-MM-DD",onChange:(e,t)=>{if(e){let[t,a]=e;N({...j,ask_date_start:(null==t?void 0:t.format("YYYY-MM-DD"))||"",ask_date_end:(null==a?void 0:a.format("YYYY-MM-DD"))||""})}else N({...j,ask_date_start:"",ask_date_end:""})},placeholder:["In\xedcio avalia\xe7\xe3o (min)","In\xedcio avalia\xe7\xe3o (max)"],style:{width:400}}),(0,n.jsx)(I,{format:"YYYY-MM-DD",onChange:(e,t)=>{if(e){let[t,a]=e;N({...j,answer_date_start:(null==t?void 0:t.format("YYYY-MM-DD"))||"",answer_date_end:(null==a?void 0:a.format("YYYY-MM-DD"))||""})}else N({...j,answer_date_start:"",answer_date_end:""})},placeholder:["Fim avalia\xe7\xe3o (min)","Fim avalia\xe7\xe3o (max)"],style:{width:400}}),(0,n.jsx)("div",{style:{width:400},children:(0,n.jsx)(u.ZP,{type:"primary",onClick:()=>{i(e.filter(e=>![e.RAZAO.toLowerCase().includes(j.RAZAO.toLowerCase()),e.CPF_CNPJ.includes(j.CPF_CNPJ.replace(/\D/g,"")),j.ATIVO===e.ATIVO||"TODOS"===j.ATIVO||""===j.ATIVO,0===j.ESTADO.length||j.ESTADO.includes(e.ESTADO),0===j.CIDADE.length||j.CIDADE.includes(e.CIDADE),0===j.contact_method.length||j.contact_method.includes(e.contact_method||"NULL"),(!j.ask_date_start||new Date(e.ask_date)>=new Date(j.ask_date_start))&&(!j.ask_date_end||new Date(e.ask_date)<=new Date(j.ask_date_end)),(!j.answer_date_start||new Date(e.answer_date)>=new Date(j.answer_date_start))&&(!j.answer_date_end||new Date(e.answer_date)<=new Date(j.answer_date_end))].includes(!1)))},style:{width:150},children:"Filtrar"})})]}),(0,n.jsx)(_.Z,{columns:x,dataSource:a,rowKey:"CODIGO_ATENDIMENTO",tableLayout:"auto",loading:c,pagination:{current:p,total:D,pageSize:20},onChange:e=>{O(e.current)}}),(0,n.jsx)("div",{className:o()["chart-container"],children:(0,n.jsx)(m.$Q,{data:{labels:y,datasets:[{label:"Clientes",data:T,backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:e=>{let t=e.raw;return"Clientes: ".concat(t)}}}}}})})]})}},3019:function(e){e.exports={main:"page_main__80_xa","filters-container":"page_filters-container__rH1kC","charts-container":"page_charts-container__Rf1Vm",tag:"page_tag__X0Ycm",SIM:"page_SIM__5lYqx",NAO:"page_NAO__QPPZH"}}},function(e){e.O(0,[235,674,490,971,23,744],function(){return e(e.s=1105)}),_N_E=e.O()}]);